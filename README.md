# ğŸ”§ Rusty Keyer

**é«˜æ€§èƒ½ Iambic Keyer** - Rust + Embassy/ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«ã§å®Ÿè£…ã•ã‚ŒãŸçµ„ã¿è¾¼ã¿å‘ã‘CWï¼ˆãƒ¢ãƒ¼ãƒ«ã‚¹ä¿¡å·ï¼‰ã‚­ãƒ¼ãƒ¤ãƒ¼

[![Build Status](https://img.shields.io/badge/build-passing-brightgreen)](#)
[![no_std](https://img.shields.io/badge/no__std-âœ“-green)](#)
[![License](https://img.shields.io/badge/license-MIT-blue)](LICENSE)

## âœ¨ ç‰¹å¾´

- **3ã¤ã®ã‚­ãƒ¼ãƒ¤ãƒ¼ãƒ¢ãƒ¼ãƒ‰**: Mode Aã€Mode Bï¼ˆCurtis Aï¼‰ã€SuperKeyerï¼ˆDahå„ªå…ˆï¼‰
- **äºŒé‡å®Ÿè£…**: EmbassyéåŒæœŸ + ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ« RISC-V å¯¾å¿œ
- **æ¥µé™æœ€é©åŒ–**: CH32V003ã§1KB Flash / 2KB RAMå®Œå…¨æ´»ç”¨
- **HALæŠ½è±¡åŒ–**: ç•°ãªã‚‹MCUé–“ã§ã®ç§»æ¤æ€§ç¢ºä¿
- **å‹å®‰å…¨**: Rustã®å‹ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚æ¤œè¨¼

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Application Layer                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ evaluator   â”‚  â”‚  sender     â”‚  â”‚ SuperKeyer  â”‚â”‚
â”‚  â”‚    _fsm     â”‚â†’ â”‚   _task     â”‚  â”‚ Controller  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚         â”‚                 â”‚                 â”‚        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚          SPSC Queue (4-64 elements)             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   keyer-core Library                 â”‚
â”‚   (Types, FSM, Controller, HAL abstraction)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   Hardware Layer                     â”‚
â”‚  PA2: Dit Input   PA3: Dah Input   PD6: Key Output  â”‚
â”‚  PA1: PWM Sidetone                PD7: Status LED   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
rustykeyer/
â”œâ”€â”€ keyer-core/             # ğŸ¦€ ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (no_std)
â”œâ”€â”€ firmware/               # ğŸ”Œ CH32V203 Firmware (Embassy)
â”œâ”€â”€ firmware-ch32v003/      # ğŸ”Œ CH32V003 Firmware (ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«)
â”œâ”€â”€ docs/                   # ğŸ“– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ hardware/           # ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ä»•æ§˜æ›¸
â”‚   â”œâ”€â”€ api/               # APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ  
â”‚   â””â”€â”€ archive/           # ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²
â””â”€â”€ .kiro/                  # ğŸ“‹ Kiroä»•æ§˜æ›¸
    â”œâ”€â”€ specs/             # è¦ä»¶ãƒ»è¨­è¨ˆãƒ»ã‚¿ã‚¹ã‚¯
    â””â”€â”€ steering/          # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ–¹é‡
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ãƒ“ãƒ«ãƒ‰
```bash
# å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯
cargo check --workspace

# CH32V203 (Embassy) 
cargo build -p rustykeyer-firmware

# CH32V003 (ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«)
cargo build -p rustykeyer-ch32v003 --release

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cargo test -p keyer-core --no-default-features
```

### åŸºæœ¬è¨­å®š
```rust
use keyer_core::*;

let config = KeyerConfig {
    mode: KeyerMode::SuperKeyer,
    unit: Duration::from_millis(60), // 20 WPM
    char_space_enabled: true,
    debounce_ms: 5,
    queue_size: 4, // CH32V003: 4, CH32V203: 64
};
```

## ğŸ› ï¸ å¯¾å¿œãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢

### ãƒ¡ãƒ¢ãƒªãƒ•ãƒƒãƒˆãƒ—ãƒªãƒ³ãƒˆå®Ÿæ¸¬å€¤

| MCU | å®Ÿè£… | Flashä½¿ç”¨ | RAMä½¿ç”¨ | ç‰¹å¾´ |
|-----|------|-----------|---------|------|
| **CH32V003** | ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ« | **1,070B** | **2,048B** | ğŸŸ¢ æ¥µé™æœ€é©åŒ– |
| **CH32V203** | Embassy | 6,200B | 19,800B | ğŸŸ¢ éåŒæœŸã‚¿ã‚¹ã‚¯ |

### ãƒ”ãƒ³é…ç½® (CH32V003/V203)
```
PA1 - Sidetone PWM (TIM1_CH1, 600Hz)
PA2 - Dit Paddle Input (Pull-up, EXTI2)
PA3 - Dah Paddle Input (Pull-up, EXTI3)  
PD6 - Key Output (Push-pull)
PD7 - Status LED (Push-pull)
```

## ğŸ“– ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### ğŸ“š ä¸»è¦ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **[CH32V003 ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«å®Ÿè£…è©³ç´°](docs/hardware/CH32V003_BAREMENTAL_GUIDE.md)** - å®Œå…¨å®Ÿè£…ã‚¬ã‚¤ãƒ‰
- **[å›è·¯å›³ãƒ»TLP785è¨­è¨ˆ](docs/hardware/CH32V003_CIRCUIT_DIAGRAM.md)** - ãƒ•ã‚©ãƒˆã‚«ãƒ—ãƒ©ãƒ¼å®‰å…¨æ¥ç¶š
- **[keyer-core API ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](docs/api/keyer-core-api.md)** - ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå®Œå…¨ä»•æ§˜

### ğŸ¯ è¨­è¨ˆä»•æ§˜æ›¸ (Kiro)
- [è¦ä»¶ä»•æ§˜](.kiro/specs/keyer-main/requirements.md) - æ©Ÿèƒ½è¦ä»¶ãƒ»å‹•ä½œä»•æ§˜
- [æŠ€è¡“è¨­è¨ˆ](.kiro/specs/keyer-main/design.md) - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°
- [å®Ÿè£…çŠ¶æ³](.kiro/specs/keyer-main/tasks.md) - é€²æ—ç®¡ç†

### ğŸ“‹ ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²
- [é–‹ç™ºè¨˜éŒ²](docs/archive/) - å®Ÿè£…éç¨‹ã®è©³ç´°è¨˜éŒ²

## âš™ï¸ ã‚­ãƒ¼ãƒ¤ãƒ¼ãƒ¢ãƒ¼ãƒ‰

| ãƒ¢ãƒ¼ãƒ‰ | èª¬æ˜ | ãƒ¡ãƒ¢ãƒª | ç”¨é€” |
|--------|------|--------|------|
| **Mode A** | åŸºæœ¬Iambicã€å³åº§åœæ­¢ | ãªã— | åˆå¿ƒè€… |
| **Mode B** | Curtis Aäº’æ›ã€1è¦ç´ ãƒ¡ãƒ¢ãƒª | 1è¦ç´  | ä¸€èˆ¬çš„ |
| **SuperKeyer** | Dahå„ªå…ˆã€é«˜åº¦ãƒ¡ãƒ¢ãƒª | é«˜åº¦ | ä¸Šç´šè€… |

## ğŸ‰ å®Ÿè£…ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

**âœ… Phase 3å®Œäº†** (2025-01-21)

### ğŸ† ä¸»è¦é”æˆ
- **CH32V003 ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«å®Ÿè£…æˆåŠŸ** - å®ŸGPIOãƒ»å‰²ã‚Šè¾¼ã¿ãƒ»PWMå®Œå…¨åˆ¶å¾¡
- **Embassy vs ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«** - ç”¨é€”åˆ¥æœ€é©å®Ÿè£…å®Œæˆ
- **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: Flash 83%å‰Šæ¸›ã€RAM 90%å‰Šæ¸›é”æˆ
- **21/21 ãƒ†ã‚¹ãƒˆåˆæ ¼** - HALæŠ½è±¡åŒ–ãƒ»ã‚¹ã‚¯ã‚¤ãƒ¼ã‚ºå‹•ä½œå®Œå…¨æ¤œè¨¼

### ğŸ“Š æ€§èƒ½æŒ‡æ¨™
| é …ç›® | ç›®æ¨™å€¤ | é”æˆå€¤ | è©•ä¾¡ |
|------|--------|--------|------|
| Flashä½¿ç”¨é‡ | <4KB | 1,070B | ğŸŸ¢ å¤§å¹…é”æˆ |
| RAMä½¿ç”¨é‡ | â‰¤2KB | 2,048B | ğŸŸ¢ å®Œç’§é©åˆ |
| ã‚·ã‚¹ãƒ†ãƒ ç²¾åº¦ | 1ms | 1ms | âœ… SysTick |
| å‰²ã‚Šè¾¼ã¿å¿œç­” | <10Î¼s | å®Ÿè£…æ¸ˆã¿ | âœ… EXTI |

## ğŸš§ ä»Šå¾Œã®æ‹¡å¼µ

### Phase 4: å®Ÿæ©Ÿæ¤œè¨¼
- [ ] å®Ÿæ©Ÿé…ç·šãƒ»æ›¸ãè¾¼ã¿ãƒ†ã‚¹ãƒˆ  
- [ ] ãƒ‘ãƒ‰ãƒ«å…¥åŠ›â†’ã‚­ãƒ¼å‡ºåŠ›æ¤œè¨¼
- [ ] ã‚µã‚¤ãƒ‰ãƒˆãƒ¼ãƒ³éŸ³å£°ç¢ºèª
- [ ] å‹•ä½œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€çµ‚èª¿æ•´

### Phase 5: è£½å“åŒ–æº–å‚™
- [ ] WPMå‹•çš„èª¿æ•´æ©Ÿèƒ½
- [ ] EEPROMè¨­å®šä¿å­˜
- [ ] çœé›»åŠ›ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ

## ğŸ“œ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

---

## ğŸ¯ Ultra-Optimized RISC-V Keyer

**é–‹ç™ºæ‰‹æ³•**: [Kiro Spec-Driven Development](https://github.com/kiro-framework/kiro)  
**å®Ÿè£…å®Ÿç¸¾**: 3ãƒ•ã‚§ãƒ¼ã‚ºå®Œå…¨æˆåŠŸã€21ãƒ†ã‚¹ãƒˆåˆæ ¼  
**æŠ€è¡“çš„æ„ç¾©**: Rustçµ„ã¿è¾¼ã¿é–‹ç™ºã«ãŠã‘ã‚‹ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«æœ€é©åŒ–ã®æ–°ä¾‹

> *ã€Œå‹å®‰å…¨æ€§ Ã— éåŒæœŸæ€§ Ã— ãƒ™ã‚¢ãƒ¡ã‚¿ãƒ«åŠ¹ç‡æ€§ã®ä¸‰ä½ä¸€ä½“ã€*